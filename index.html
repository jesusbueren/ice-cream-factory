<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>General Equilibrium Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #f8fafc; --panel: #ffffff; --primary: #2563eb; --secondary: #059669; --accent: #dc2626; --text: #1e293b; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .dashboard { max-width: 1200px; margin: auto; display: flex; flex-direction: column; gap: 20px; }
        
        /* Top Control Panel */
        .panel { background: var(--panel); padding: 20px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .controls-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-bottom: 20px; }
        .price-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; border-top: 1px solid #e2e8f0; pt: 20px; margin-top: 20px; padding-top: 20px; }
        
        .slider-wrap { display: flex; flex-direction: column; gap: 8px; }
        .slider-wrap label { font-weight: 600; font-size: 0.9rem; display: flex; justify-content: space-between; }
        input[type=range] { width: 100%; cursor: pointer; }

        /* Stats Row */
        .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
        .stat-card { background: #f1f5f9; padding: 12px; border-radius: 8px; text-align: center; }
        .stat-label { font-size: 0.75rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; }
        .stat-value { font-size: 1.1rem; font-weight: 700; display: block; }

        /* Charts */
        .charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .chart-container { background: white; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0; height: 320px; }
        .chart-header { font-size: 0.85rem; font-weight: 700; text-align: center; color: var(--primary); margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="dashboard">
    <div class="panel">
        <div class="controls-grid">
            <div class="slider-wrap">
                <label>Fixed Capital (K̄) <span id="outK">50</span></label>
                <input type="range" id="Kbar" min="10" max="100" value="50">
            </div>
            <div class="slider-wrap">
                <label>Fixed Labor (L̄) <span id="outL">80</span></label>
                <input type="range" id="Lbar" min="10" max="100" value="80">
            </div>
            <div class="slider-wrap">
                <label>Alpha (α) <span id="outA">0.30</span></label>
                <input type="range" id="Alpha" min="0.1" max="0.9" step="0.05" value="0.30">
            </div>
        </div>

        <div class="price-grid">
            <div class="slider-wrap">
                <label style="color: var(--accent)">Market Wage (w) <span id="outW">43</span></label>
                <input type="range" id="Wage" min="10" max="100" value="43">
            </div>
            <div class="slider-wrap">
                <label style="color: var(--accent)">Rental Rate (r) <span id="outR">18</span></label>
                <input type="range" id="Rent" min="5" max="50" value="18">
            </div>
        </div>

        <div class="stats-row" style="margin-top: 20px;">
            <div class="stat-card">
                <span class="stat-label">Total Output (Y)</span>
                <span id="statY" class="stat-value">0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Labor Share (wL/Y)</span>
                <span id="statLS" class="stat-value">0%</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Capital Share (rK/Y)</span>
                <span id="statKS" class="stat-value">0%</span>
            </div>
            <div class="stat-card" id="equilBox" style="border: 2px solid transparent;">
                <span class="stat-label">Market Status</span>
                <span id="statStatus" class="stat-value">Checking...</span>
            </div>
        </div>
    </div>

    <div class="charts-grid">
        <div class="chart-container">
            <div class="chart-header">LABOR MARKET: MPL = (1-α)A(K/L)^α</div>
            <canvas id="chartMPL"></canvas>
        </div>
        <div class="chart-container">
            <div class="chart-header">CAPITAL MARKET: MPK = αA(L/K)^(1-α)</div>
            <canvas id="chartMPK"></canvas>
        </div>
        <div class="chart-container">
            <div class="chart-header">PRODUCTION: Y = f(L) | Fixed K</div>
            <canvas id="chartYL"></canvas>
        </div>
        <div class="chart-container">
            <div class="chart-header">PRODUCTION: Y = f(K) | Fixed L</div>
            <canvas id="chartYK"></canvas>
        </div>
    </div>
</div>

<script>
    const A = 100;
    let charts = {};

    function getVal(id) { return parseFloat(document.getElementById(id).value); }

    function init() {
        const commonOptions = {
            responsive: true, maintainAspectRatio: false, animation: false,
            plugins: { legend: { display: false } },
            scales: { x: { type: 'linear', min: 0, max: 100 }, y: { beginAtZero: true } }
        };

        const ctxs = ['chartMPL', 'chartMPK', 'chartYL', 'chartYK'];
        ctxs.forEach(id => {
            charts[id] = new Chart(document.getElementById(id), {
                type: 'line',
                data: { datasets: [
                    { label: 'Function', data: [], borderColor: '#2563eb', pointRadius: 0, borderWidth: 2 },
                    { label: 'Supply/Point', data: [], borderColor: '#64748b', borderDash: [5,5], pointRadius: 0 },
                    { label: 'Price/Target', data: [], borderColor: '#dc2626', borderWidth: 2, pointRadius: 0 }
                ]},
                options: commonOptions
            });
        });
        update();
    }

    function update() {
        const K = getVal('Kbar'), L = getVal('Lbar'), a = getVal('Alpha');
        const w = getVal('Wage'), r = getVal('Rent');

        document.getElementById('outK').innerText = K;
        document.getElementById('outL').innerText = L;
        document.getElementById('outA').innerText = a.toFixed(2);
        document.getElementById('outW').innerText = w;
        document.getElementById('outR').innerText = r;

        const Y = A * Math.pow(K, a) * Math.pow(L, 1-a);
        const eqW = (1-a) * A * Math.pow(K, a) * Math.pow(L, -a);
        const eqR = a * A * Math.pow(K, a-1) * Math.pow(L, 1-a);

        // Stats
        document.getElementById('statY').innerText = Y.toFixed(1);
        document.getElementById('statLS').innerText = ((w * L / Y) * 100).toFixed(1) + "%";
        document.getElementById('statKS').innerText = ((r * K / Y) * 100).toFixed(1) + "%";
        
        const statusBox = document.getElementById('equilBox');
        const statusVal = document.getElementById('statStatus');
        const isEquil = Math.abs(w-eqW) < 2 && Math.abs(r-eqR) < 1;
        statusVal.innerText = isEquil ? "EQUILIBRIUM" : "DISEQUILIBRIUM";
        statusBox.style.borderColor = isEquil ? "#059669" : "#dc2626";
        statusBox.style.color = isEquil ? "#059669" : "#dc2626";

        // Generate Data
        let dMPL = [], dMPK = [], dYL = [], dYK = [];
        for(let i=1; i<=100; i++) {
            dMPL.push({x: i, y: (1-a) * A * Math.pow(K, a) * Math.pow(i, -a)});
            dMPK.push({x: i, y: a * A * Math.pow(i, a-1) * Math.pow(L, 1-a)});
            dYL.push({x: i, y: A * Math.pow(K, a) * Math.pow(i, 1-a)});
            dYK.push({x: i, y: A * Math.pow(i, a) * Math.pow(L, 1-a)});
        }

        // Update MPL Chart
        charts.chartMPL.data.datasets[0].data = dMPL;
        charts.chartMPL.data.datasets[1].data = [{x: L, y: 0}, {x: L, y: 120}]; // Supply
        charts.chartMPL.data.datasets[2].data = [{x: 0, y: w}, {x: 100, y: w}]; // Price
        
        // Update MPK Chart
        charts.chartMPK.data.datasets[0].data = dMPK;
        charts.chartMPK.data.datasets[1].data = [{x: K, y: 0}, {x: K, y: 60}];
        charts.chartMPK.data.datasets[2].data = [{x: 0, y: r}, {x: 100, y: r}];

        // Update Y(L) Chart
        charts.chartYL.data.datasets[0].data = dYL;
        charts.chartYL.data.datasets[1].data = [{x: L, y: 0}, {x: L, y: Y}, {x: 0, y: Y}]; // Dot intersection
        charts.chartYL.data.datasets[1].pointRadius = 4;

        // Update Y(K) Chart
        charts.chartYK.data.datasets[0].data = dYK;
        charts.chartYK.data.datasets[1].data = [{x: K, y: 0}, {x: K, y: Y}, {x: 0, y: Y}];
        charts.chartYK.data.datasets[1].pointRadius = 4;

        Object.values(charts).forEach(c => c.update());
    }

    document.querySelectorAll('input').forEach(i => i.addEventListener('input', update));
    window.onload = init;
</script>
</body>
</html>
